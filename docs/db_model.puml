@startuml

!theme monokai from ..\data
hide class empty members


legend top right
    purposes = ('Похудение', 'Набор мышечной массы', 'Поддержание веса')
    levels = ('Низкий', 'Умеренный', 'Высокий', 'Интенсивный')
end legend


class User {
    {field}<&key> <b>id</b>: integer unsigned
    {field}<b>username</b>: varchar(100)
    {field}<b>password</b>: varchar(50)
}


class UserData {
    {field}<&key> <b>id</b>: integer unsigned
    {field}<b>full_name</b>: varchar(50)
    {field}<b>age</b>: tinyint unsigned
    {field}<b>sex</b>: enum('M', 'F')
    {field}<b>height</b>: tinyint unsigned
    {field}<b>purpose</b>: enum(<i>purposes</i>)
    {field}<b>activity_level</b>: enum(<i>levels</i>)
}


class Reports {
    {field}<&key> <b>id</b>: integer unsigned
    {field}<b>date</b>: date
    {field}<b>product_id</b>: date
    {field}<b>water</b>: decimal(2,1)
    {field}<b>activity_id</b>: date
    {field}<b>user_data_id</b>: integer unsigned
}


class WeightChange{
    {field}<&key> <b>id</b>: integer unsigned
    {field}<b>date</b>: date
    {field}<b>weight</b>: decimal(4,1)
    {field}<b>bmi</b>: decimal(3,1)
    {field}<b>user_data_id</b>: integer unsigned
}


class Product {
    {field}<&key> <b>id</b>: integer unsigned
    {field}<b>name</b>: varchar(30)
    {field}<b>calories</b>: smallint unsigned
    {field}<b>proteins</b>: smallint unsigned
    {field}<b>fats</b>: smallint unsigned
    {field}<b>carbohydrates</b>: smallint unsigned
}


class Activity {
    {field}<&key> <b>id</b>: integer unsigned
    {field}<b>name</b>: varchar(30)
    {field}<b>runtime</b>: tinyint unsigned
    {field}<b>burned_calories</b>: smallint unsigned
}


'подписи: кратность связей
User "1" --- "1" UserData

UserData "1" -left- "*" WeightChange
UserData "1" -right- "*" Reports

Reports "*" --- "1" Product : " "
note right on link
    <b>Reports</b> и <b>Product</b>, а также
    <b>Reports</b> и <b>Activity</b> связаны
    как <u>один-ко-многим</u>
end note
Reports "*" --- "1" Activity


note "<b>UserData</b> и <b>Product</b> связаны как <u>многие-ко-многим</u>" as n3

note "<b>UserData</b> и <b>Activity</b> связаны как <u>многие-ко-многим</u>" as n4

note "<b>Reports</b> выступает в качестве вспомогательной \nтаблицы для связей <u>многие-ко-многим</u>, но помимо \nэтого содержит и другие поля" as n5


UserData .. n3
n3 .. Product

Activity .. n4
n5 .. Reports


@enduml